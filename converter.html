<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>أداة تحويل الروابط</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f0f2f5; padding: 20px; }
        h1 { color: #333; }
        textarea { width: 95%; height: 200px; margin-bottom: 10px; padding: 10px; font-size: 14px; border: 1px solid #ccc; border-radius: 8px; }
        
        /* حاوية الأزرار */
        .button-container { display: flex; gap: 10px; }

        button { 
            padding: 12px 20px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 16px; 
            font-weight: bold; 
            transition: background-color 0.2s;
        }

        /* زر التحويل (أزرق) */
        #convert-btn { background: #0073aa; color: white; }
        #convert-btn:hover { background: #005a87; }

        /* زر النسخ (أخضر) */
        #copy-btn { background: #28a745; color: white; }
        #copy-btn:hover { background: #218838; }

        /* زر "تم النسخ" (رمادي) */
        #copy-btn.copied { background: #6c757d; }
        
        #output { background: #e9ebee; border: 1px solid #ccc; padding: 15px; border-radius: 8px; margin-top: 15px; font-family: "Courier New", Courier, monospace; }
        #output::before { content: "الكود الجاهز للصق في ووردبريس:"; display: block; font-weight: bold; margin-bottom: 10px; font-family: sans-serif; color: #d9534f; }
    </style>
</head>
<body>

    <h1>أداة تحويل الروابط (لووردبريس)</h1>
    <p>الصق بياناتك الخام هنا (سطر عنوان، سطر رابط):</p>
    <textarea id="raw-input" placeholder="المرشد في الأطفال👇&#10;go.doctorhypo.me/c7&#10;&#10;تصنيف المضادات الحيوية👇&#10;t.me/doctorhypo/8131"></textarea>
    
    <div class="button-container">
        <button id="convert-btn" onclick="convertData()">تحويل البيانات</button>
        <button id="copy-btn" onclick="copyToClipboard()">نسخ الناتج</button>
    </div>
    
    <pre id="output"></pre>

    <script>
        // وظيفة التحويل
        function convertData() {
            const rawText = document.getElementById('raw-input').value;
            const lines = rawText.trim().split('\n');
            let output = '';

            for (let i = 0; i < lines.length; i += 2) {
                const rawTitle = lines[i] ? lines[i].trim() : '';
                const title = rawTitle.replace(/(\p{Emoji})+$/gu, '').trim();
                let url = lines[i + 1] ? lines[i + 1].trim() : '';

                if (!title || !url) {
                    if (!title && lines[i+1]) { i--; continue; } 
                    if (title && !url) { i--; continue; } 
                    continue;
                }
                
                const cleanTitle = title.replace(/"/g, '\\"'); 
                output += `    { title: "${cleanTitle}", url: "${url}" },\n`;
            }
            
            document.getElementById('output').textContent = output;
        }

        // ✨ وظيفة النسخ الجديدة
        function copyToClipboard() {
            const outputText = document.getElementById('output').textContent;
            const copyButton = document.getElementById('copy-btn');

            if (!outputText) {
                alert("لا يوجد شيء لنسخه! اضغط 'تحويل' أولاً.");
                return;
            }

            navigator.clipboard.writeText(outputText).then(function() {
                // نجح النسخ
                copyButton.textContent = 'تم النسخ!';
                copyButton.classList.add('copied'); // يغير لونه للرمادي
                
                // إعادة الزر لوضعه الطبيعي بعد ثانيتين
                setTimeout(function() {
                    copyButton.textContent = 'نسخ الناتج';
                    copyButton.classList.remove('copied');
                }, 2000);

            }, function(err) {
                // فشل النسخ
                alert('فشل النسخ. يرجى النسخ يدوياً.');
            });
        }
    </script>

</body>
</html>
